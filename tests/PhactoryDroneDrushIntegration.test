<?php
module_load_include('inc', 'phactorydrone', 'tests/PhactoryDroneTestCase');
module_load_include('inc', 'phactorydrone', 'phactorydrone.drush');

class PhactoryDroneDrushIntegrationTest extends PhactoryDroneTestCase {
  public static function getInfo() {
    return array(
      'name' => 'Drush integration unit tests',
      'description' => 'Test the methods for integrating with drush',
      'group' => 'Phactory Drone',
    );
  }

  public function testDrushPhactoryDroneCreateInternals() {
    $this->load_factory_definitions();

    $node = _drush_factorydrone_create('node');
    $this->assertNotNull($node->nid);
  }

  public function testDrushPhactoryDroneCreateExternalsWithPorcelain() {
    $command_output = `drush pd-create 'node' --porcelain --factory_path='{$this->factory_path}'`;
    $node = unserialize($command_output);
    $this->assertNotNull($node->nid);
  }

  public function testDrushPhactoryDroneCreateExternals() {
    $command_output = `drush pd-create 'node' --factory_path='{$this->factory_path}'`;
    $this->assertNotNull($command_output);
  }
}
